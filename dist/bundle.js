(()=>{function e(){document.getElementById("loadingIndicator").classList.remove("loader")}function t(t){if("Enter"===t.key||"click"===t.type){document.getElementById("loadingIndicator").classList.add("loader");const t=`https://openlibrary.org/search.json?q=${document.getElementById("search_input").value}&limit=8`;$.ajax({url:t,method:"GET",success:function(t){const n=document.getElementById("results");n.innerHTML="",document.getElementById("loadingIndicator").classList.remove("loader"),t.docs.forEach((e=>{const t=document.createElement("div");t.classList.add("book");const o=document.createElement("h2");o.textContent=e.title,t.appendChild(o);const i=document.createElement("p");i.textContent=`${e.author_name?e.author_name.join(", "):"Unknown"}`,i.classList.add("author"),t.appendChild(i);const c=document.createElement("button");if(c.textContent="Description",c.addEventListener("click",(function(){const n=`https://openlibrary.org${e.key}.json`;$.ajax({url:n,method:"GET",success:function(e){const n=document.createElement("div");t.appendChild(n),n.classList.add("bckDes"),o.remove(),i.remove(),c.remove();const s=document.createElement("p");if(s.textContent=e.description?e.description.value:"No description available",console.log("Descrizione del libro:",s.textContent),e.description&&e.description.value){let t=e.description.value;const n="----------",o="[1]";let i=t.indexOf(n),c=t.indexOf(o);-1!==i&&-1!==c&&(t=t.substring(0,i).trim()),i=t.indexOf(n),-1!==i&&(t=t.substring(0,i).trim()),s.textContent=t}else s.textContent="No description available";n.appendChild(s),s.classList.add("description");const d=document.createElement("span");d.textContent="CLOSE",d.classList.add("close"),n.appendChild(d),d.addEventListener("click",(function(){n.style.display="none",t.appendChild(o),t.appendChild(i),t.appendChild(c)}))},error:function(e){console.log("Si è verificato un errore nella richiesta della descrizione:",e),alert("Si è verificato un errore nella richiesta della descrizione."),closeIcon.addEventListener("click",(function(){backgroundDescription.style.display="none"}))}})})),t.appendChild(c),e.cover_i){const n=`https://covers.openlibrary.org/b/id/${e.cover_i}-M.jpg`,o=document.createElement("img");o.src=n,t.appendChild(o)}n.appendChild(t),$(document).on("mouseenter",".book",(function(){$(this).find("img").css({transform:"scale(1.1)",filter:"brightness(0.5)"}),$(this).find("h2, p, button, span").css({opacity:1})})).on("mouseleave",".book",(function(){$(this).find("img").css({transform:"scale(1)",filter:"brightness(0.7)"}),$(this).find("h2, p, button, span").css({opacity:0})}))})),e(),document.getElementById("title_results").scrollIntoView({behavior:"smooth"})},error:function(t){console.log("Si è verificato un errore:",t),e(),alert("Ci dispiace, non è stato trovato nessun libro.")}})}}$(document).ready((function(){$(".navbar").click((function(){$(".hide_menu").toggleClass("wide"),$(".circle").toggleClass("circleoff"),$(".icon_bar").toggleClass("icon_baroff")}))})),document.getElementById("search_input").addEventListener("keypress",t),document.getElementById("search_icon").addEventListener("click",t),document.getElementById("loadMoreBtn").addEventListener("click",(function(){const e=document.getElementById("results"),t=e.lastElementChild,n=t.offsetTop+t.clientHeight;if(window.scrollY+window.innerHeight>n-20){const t=`https://openlibrary.org/search.json?q=${document.getElementById("search_input").value}&limit=4&offset=${e.children.length}`;$.ajax({url:t,method:"GET",success:function(t){t.docs.forEach((t=>{const n=document.createElement("div");n.classList.add("book");const o=document.createElement("h2");o.textContent=t.title,n.appendChild(o);const i=document.createElement("p");i.textContent=`${t.author_name?t.author_name.join(", "):"Unknown"}`,i.classList.add("author"),n.appendChild(i);const c=document.createElement("button");if(c.textContent="Description",c.addEventListener("click",(function(){const e=`https://openlibrary.org${t.key}.json`;$.ajax({url:e,method:"GET",success:function(e){const t=document.createElement("div");n.appendChild(t),t.classList.add("bckDes"),o.remove(),i.remove(),c.remove();const s=document.createElement("p");if(s.textContent=e.description?e.description.value:"No description available",e.description&&e.description.value){const t=e.description.value,n="----------",o="Also contained in:",i=t.indexOf(n);let c=t.indexOf(o);-1===c&&(c=t.length),s.textContent=-1!==i&&-1!==c?t.substring(i+n.length,c).trim():t}else s.textContent="No description available";t.appendChild(s),s.classList.add("description");const d=document.createElement("span");d.textContent="CLOSE",d.classList.add("close"),t.appendChild(d),d.addEventListener("click",(function(){t.style.display="none",n.appendChild(o),n.appendChild(i),n.appendChild(c)}))},error:function(e){console.log("Si è verificato un errore nella richiesta della descrizione:",e),alert("Si è verificato un errore nella richiesta della descrizione."),closeIcon.addEventListener("click",(function(){backgroundDescription.style.display="none"}))}})})),n.appendChild(c),t.cover_i){const e=`https://covers.openlibrary.org/b/id/${t.cover_i}-M.jpg`,o=document.createElement("img");o.src=e,n.appendChild(o)}e.appendChild(n)}))},error:function(e){console.log("Si è verificato un errore:",e)}})}}))})();