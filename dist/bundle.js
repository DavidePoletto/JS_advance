(()=>{function e(){document.getElementById("loadingIndicator").classList.remove("loader")}function t(t){if("Enter"===t.key||"click"===t.type){document.getElementById("loadingIndicator").classList.add("loader");var n=document.getElementById("search_input").value,i="https://openlibrary.org/search.json?q=".concat(n,"&limit=8");$.ajax({url:i,method:"GET",success:function(t){var n=document.getElementById("results");n.innerHTML="",document.getElementById("loadingIndicator").classList.remove("loader"),t.docs.forEach((function(e){var t=document.createElement("div");t.classList.add("book");var i=document.createElement("h2");i.textContent=e.title,t.appendChild(i);var o=document.createElement("p");o.textContent="".concat(e.author_name?e.author_name.join(", "):"Unknown"),o.classList.add("author"),t.appendChild(o);var c=document.createElement("button");if(c.textContent="Description",c.addEventListener("click",(function(){var n="https://openlibrary.org".concat(e.key,".json");$.ajax({url:n,method:"GET",success:function(e){var n=document.createElement("div");t.appendChild(n),n.classList.add("bckDes"),i.remove(),o.remove(),c.remove();var a=document.createElement("p");if(a.textContent=e.description?e.description.value:"No description available",console.log("Descrizione del libro:",a.textContent),e.description&&e.description.value){var r=e.description.value,d="----------",s=r.indexOf(d),l=r.indexOf("[1]");-1!==s&&-1!==l&&(r=r.substring(0,s).trim()),-1!==(s=r.indexOf(d))&&(r=r.substring(0,s).trim()),a.textContent=r}else a.textContent="No description available";n.appendChild(a),a.classList.add("description");var p=document.createElement("span");p.textContent="CLOSE",p.classList.add("close"),n.appendChild(p),p.addEventListener("click",(function(){n.style.display="none",t.appendChild(i),t.appendChild(o),t.appendChild(c)}))},error:function(e){console.log("Si è verificato un errore nella richiesta della descrizione:",e),alert("Si è verificato un errore nella richiesta della descrizione."),closeIcon.addEventListener("click",(function(){backgroundDescription.style.display="none"}))}})})),t.appendChild(c),e.cover_i){var a="https://covers.openlibrary.org/b/id/".concat(e.cover_i,"-M.jpg"),r=document.createElement("img");r.src=a,t.appendChild(r)}n.appendChild(t),$(document).on("mouseenter",".book",(function(){$(this).find("img").css({transform:"scale(1.1)",filter:"brightness(0.5)"}),$(this).find("h2, p, button, span").css({opacity:1})})).on("mouseleave",".book",(function(){$(this).find("img").css({transform:"scale(1)",filter:"brightness(0.7)"}),$(this).find("h2, p, button, span").css({opacity:0})}))})),e(),document.getElementById("title_results").scrollIntoView({behavior:"smooth"})},error:function(t){console.log("Si è verificato un errore:",t),e(),alert("Ci dispiace, non è stato trovato nessun libro.")}})}}$(document).ready((function(){$(".navbar").click((function(){$(".hide_menu").toggleClass("wide"),$(".circle").toggleClass("circleoff"),$(".icon_bar").toggleClass("icon_baroff")}))})),document.getElementById("search_input").addEventListener("keypress",t),document.getElementById("search_icon").addEventListener("click",t),document.getElementById("loadMoreBtn").addEventListener("click",(function(){var e=document.getElementById("results"),t=e.lastElementChild,n=t.offsetTop+t.clientHeight;if(window.scrollY+window.innerHeight>n-20){var i=document.getElementById("search_input").value,o="https://openlibrary.org/search.json?q=".concat(i,"&limit=4&offset=").concat(e.children.length);$.ajax({url:o,method:"GET",success:function(t){t.docs.forEach((function(t){var n=document.createElement("div");n.classList.add("book");var i=document.createElement("h2");i.textContent=t.title,n.appendChild(i);var o=document.createElement("p");o.textContent="".concat(t.author_name?t.author_name.join(", "):"Unknown"),o.classList.add("author"),n.appendChild(o);var c=document.createElement("button");if(c.textContent="Description",c.addEventListener("click",(function(){var e="https://openlibrary.org".concat(t.key,".json");$.ajax({url:e,method:"GET",success:function(e){var t=document.createElement("div");n.appendChild(t),t.classList.add("bckDes"),i.remove(),o.remove(),c.remove();var a=document.createElement("p");if(a.textContent=e.description?e.description.value:"No description available",e.description&&e.description.value){var r=e.description.value,d=r.indexOf("----------"),s=r.indexOf("Also contained in:");-1===s&&(s=r.length),a.textContent=-1!==d&&-1!==s?r.substring(d+10,s).trim():r}else a.textContent="No description available";t.appendChild(a),a.classList.add("description");var l=document.createElement("span");l.textContent="CLOSE",l.classList.add("close"),t.appendChild(l),l.addEventListener("click",(function(){t.style.display="none",n.appendChild(i),n.appendChild(o),n.appendChild(c)}))},error:function(e){console.log("Si è verificato un errore nella richiesta della descrizione:",e),alert("Si è verificato un errore nella richiesta della descrizione."),closeIcon.addEventListener("click",(function(){backgroundDescription.style.display="none"}))}})})),n.appendChild(c),t.cover_i){var a="https://covers.openlibrary.org/b/id/".concat(t.cover_i,"-M.jpg"),r=document.createElement("img");r.src=a,n.appendChild(r)}e.appendChild(n)}))},error:function(e){console.log("Si è verificato un errore:",e)}})}}))})();